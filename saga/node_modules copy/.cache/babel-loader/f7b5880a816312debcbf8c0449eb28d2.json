{"ast":null,"code":"import { put, spawn, call, takeLatest } from 'redux-saga/effects';\nimport { fetchServicesSuccess, fetchServiceSuccess, fetchServicesError, fetchServiceError } from '../actions/actionCreators';\nimport { FETCH_SERVICES_REQUEST, FETCH_SERVICE_REQUEST } from '../actions/actionCreators';\n\nfunction* handleServicesRequestSaga() {\n  try {\n    const items = yield call(fetchRequest, `${process.env.REACT_APP_ROOT_URL}/services`);\n    yield put(fetchServicesSuccess(items));\n  } catch (e) {\n    yield put(fetchServicesError(e.message));\n  }\n}\n\nfunction* watchServicesRequestSaga() {\n  yield takeLatest(FETCH_SERVICES_REQUEST, handleServicesRequestSaga);\n}\n\nfunction* handleServiceRequestSaga({\n  payload: {\n    serviceId\n  }\n}) {\n  try {\n    const item = yield call(fetchRequest, `${process.env.REACT_APP_ROOT_URL}/services/${serviceId}`);\n    yield put(fetchServiceSuccess(item));\n  } catch (e) {\n    yield put(fetchServiceError(e.message));\n  }\n}\n\nfunction* watchServiceRequestSaga() {\n  yield takeLatest(FETCH_SERVICE_REQUEST, handleServiceRequestSaga);\n}\n\nexport const fetchRequest = async (url, data) => {\n  const response = await fetch(url, {\n    cache: 'no-cache',\n    referrer: 'no-referrer',\n    method: data && 'POST' || 'GET',\n    headers: { ...(data && {\n        'Content-Type': 'application/json'\n      } || {})\n    },\n    body: data && JSON.stringify(data) || undefined\n  });\n\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  }\n\n  return await response.json();\n};\nexport default function* saga() {\n  yield spawn(watchServicesRequestSaga);\n  yield spawn(watchServiceRequestSaga);\n}","map":{"version":3,"sources":["c:/homework_react/homework/src/sagas/index.js"],"names":["put","spawn","call","takeLatest","fetchServicesSuccess","fetchServiceSuccess","fetchServicesError","fetchServiceError","FETCH_SERVICES_REQUEST","FETCH_SERVICE_REQUEST","handleServicesRequestSaga","items","fetchRequest","process","env","REACT_APP_ROOT_URL","e","message","watchServicesRequestSaga","handleServiceRequestSaga","payload","serviceId","item","watchServiceRequestSaga","url","data","response","fetch","cache","referrer","method","headers","body","JSON","stringify","undefined","ok","Error","statusText","json","saga"],"mappings":"AAAA,SAAQA,GAAR,EAAYC,KAAZ,EAAkBC,IAAlB,EAAuBC,UAAvB,QAAuC,oBAAvC;AACA,SAAQC,oBAAR,EAA8BC,mBAA9B,EAAmDC,kBAAnD,EAAuEC,iBAAvE,QAA8F,2BAA9F;AACA,SAAQC,sBAAR,EAA+BC,qBAA/B,QAA0D,2BAA1D;;AAIA,UAAUC,yBAAV,GAAqC;AACjC,MAAG;AACC,UAAMC,KAAK,GAAG,MAAMT,IAAI,CAACU,YAAD,EAAe,GAAEC,OAAO,CAACC,GAAR,CAAYC,kBAAmB,WAAhD,CAAxB;AACA,UAAMf,GAAG,CAACI,oBAAoB,CAACO,KAAD,CAArB,CAAT;AACH,GAHD,CAIA,OAAMK,CAAN,EAAQ;AACJ,UAAMhB,GAAG,CAACM,kBAAkB,CAACU,CAAC,CAACC,OAAH,CAAnB,CAAT;AACH;AAEJ;;AAED,UAAUC,wBAAV,GAAoC;AAChC,QAAMf,UAAU,CAACK,sBAAD,EAAyBE,yBAAzB,CAAhB;AACH;;AAED,UAAUS,wBAAV,CAAmC;AAACC,EAAAA,OAAO,EAAC;AAACC,IAAAA;AAAD;AAAT,CAAnC,EAAyD;AACrD,MAAG;AACC,UAAMC,IAAI,GAAG,MAAMpB,IAAI,CAACU,YAAD,EAAe,GAAEC,OAAO,CAACC,GAAR,CAAYC,kBAAmB,aAAYM,SAAU,EAAtE,CAAvB;AACA,UAAMrB,GAAG,CAACK,mBAAmB,CAACiB,IAAD,CAApB,CAAT;AACH,GAHD,CAIA,OAAMN,CAAN,EAAQ;AACJ,UAAMhB,GAAG,CAACO,iBAAiB,CAACS,CAAC,CAACC,OAAH,CAAlB,CAAT;AACH;AAEJ;;AAED,UAAUM,uBAAV,GAAmC;AAC/B,QAAMpB,UAAU,CAACM,qBAAD,EAAwBU,wBAAxB,CAAhB;AACH;;AAED,OAAO,MAAMP,YAAY,GAAG,OAAMY,GAAN,EAAWC,IAAX,KAAoB;AAC5C,QAAMC,QAAQ,GAAE,MAAMC,KAAK,CACvBH,GADuB,EAEvB;AACII,IAAAA,KAAK,EAAE,UADX;AAEIC,IAAAA,QAAQ,EAAE,aAFd;AAGIC,IAAAA,MAAM,EAAGL,IAAI,IAAI,MAAT,IAAoB,KAHhC;AAIIM,IAAAA,OAAO,EAAE,EACL,IAAON,IAAD,IAAU;AAAC,wBAAgB;AAAjB,OAAX,IAAoD,EAAzD;AADK,KAJb;AAOIO,IAAAA,IAAI,EAAIP,IAAD,IAAUQ,IAAI,CAACC,SAAL,CAAgBT,IAAhB,CAAX,IAAqCU;AAP/C,GAFuB,CAA3B;;AAYA,MAAI,CAACT,QAAQ,CAACU,EAAd,EAAiB;AACb,UAAM,IAAIC,KAAJ,CAAUX,QAAQ,CAACY,UAAnB,CAAN;AACH;;AACD,SAAO,MAAMZ,QAAQ,CAACa,IAAT,EAAb;AACH,CAjBM;AAmBP,eAAe,UAAUC,IAAV,GAAgB;AAC3B,QAAMvC,KAAK,CAACiB,wBAAD,CAAX;AACA,QAAMjB,KAAK,CAACsB,uBAAD,CAAX;AACH","sourcesContent":["import {put,spawn,call,takeLatest} from'redux-saga/effects';\nimport {fetchServicesSuccess, fetchServiceSuccess, fetchServicesError, fetchServiceError} from'../actions/actionCreators';\nimport {FETCH_SERVICES_REQUEST,FETCH_SERVICE_REQUEST} from'../actions/actionCreators';\n\n\n\nfunction* handleServicesRequestSaga(){\n    try{\n        const items = yield call(fetchRequest,`${process.env.REACT_APP_ROOT_URL}/services`);\n        yield put(fetchServicesSuccess(items));\n    }\n    catch(e){\n        yield put(fetchServicesError(e.message));\n    }\n    \n}\n\nfunction* watchServicesRequestSaga(){\n    yield takeLatest(FETCH_SERVICES_REQUEST, handleServicesRequestSaga);\n}\n\nfunction* handleServiceRequestSaga({payload:{serviceId}}){\n    try{\n        const item = yield call(fetchRequest,`${process.env.REACT_APP_ROOT_URL}/services/${serviceId}`);\n        yield put(fetchServiceSuccess(item));\n    }\n    catch(e){\n        yield put(fetchServiceError(e.message));\n    }\n    \n}\n\nfunction* watchServiceRequestSaga(){\n    yield takeLatest(FETCH_SERVICE_REQUEST, handleServiceRequestSaga);\n}\n\nexport const fetchRequest = async(url, data) => {\n    const response= await fetch(\n        url,\n        {\n            cache: 'no-cache',\n            referrer: 'no-referrer',\n            method: (data && 'POST') || 'GET',\n            headers: {\n                ...( ((data) && {'Content-Type': 'application/json'}) || {})\n            },\n            body: ((data) && JSON.stringify (data)) || undefined\n        }\n    );\n    if (!response.ok){\n        throw new Error(response.statusText);\n    }\n    return await response.json();\n}\n\nexport default function* saga(){\n    yield spawn(watchServicesRequestSaga);\n    yield spawn(watchServiceRequestSaga);\n}\n\n\n"]},"metadata":{},"sourceType":"module"}